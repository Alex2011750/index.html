<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHAT ACV con Voz</title>
<style>
  body { margin:0; font-family: Arial; background:#121212; color:#fff; display:flex; flex-direction:column; height:100vh; }
  #chat { flex:1; overflow-y:auto; padding:15px; }
  #inputArea { display:flex; padding:10px; background:#1E1E1E; }
  #message { flex:1; padding:10px; border:none; border-radius:8px; margin-right:10px; font-size:16px; background:#2A2A2A; color:#fff; }
  button { padding:10px 15px; border:none; border-radius:8px; background:#007AFF; color:#fff; font-weight:bold; cursor:pointer; }
  .user { text-align:right; margin:5px 0; }
  .user span { background:#007AFF; padding:8px 12px; border-radius:15px; display:inline-block; }
  .ai { text-align:left; margin:5px 0; }
  .ai span { background:#2A2A2A; padding:8px 12px; border-radius:15px; display:inline-block; }
</style>
</head>
<body>

<div id="chat"></div>

<div id="inputArea">
  <input type="text" id="message" placeholder="Escribe tu mensaje...">
  <button id="send">Enviar</button>
  <button id="voice">ðŸŽ¤</button>
</div>

<script>
const chat = document.getElementById('chat');
const input = document.getElementById('message');
const sendBtn = document.getElementById('send');
const voiceBtn = document.getElementById('voice');
const API_KEY = "TU_API_KEY_DE_OPENAI"; // AquÃ­ pon tu API Key de OpenAI

async function sendMessage(msg) {
  if(!msg) return;
  addMessage(msg, 'user');
  input.value = '';

  try {
    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "Authorization":"Bearer "+API_KEY
      },
      body: JSON.stringify({
        model:"gpt-3.5-turbo",
        messages:[{role:"user", content:msg}]
      })
    });
    
    const data = await response.json();
    const aiMsg = data.choices[0].message.content;
    addMessage(aiMsg, 'ai');
    speak(aiMsg);
  } catch(e) {
    addMessage("Error: no se pudo conectar con la IA.", 'ai');
  }
}

function addMessage(msg, sender) {
  const div = document.createElement('div');
  div.className = sender;
  div.innerHTML = `<span>${msg}</span>`;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function speak(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'es-ES';
  speechSynthesis.speak(utterance);
}

voiceBtn.onclick = () => {
  const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  recognition.lang = 'es-ES';
  recognition.start();
  recognition.onresult = (event) => {
    const speech = event.results[0][0].transcript;
    sendMessage(speech);
  };
};

sendBtn.onclick = () => sendMessage(input.value);
input.addEventListener("keypress", e => { if(e.key==="Enter") sendMessage(input.value); });
</script>

</body>
</html>
